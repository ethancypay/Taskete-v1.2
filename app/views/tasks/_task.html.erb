<div data-controller="toggle">
  <div data-task-id=<%= task.id %> data-workflow-id=<%= workflow.id %> data-controller="item" class="t-card border p-4 mb-2 mx-6">
    <div class="flex justify-between">

      <button class="text-sm flex-grow text-left" data-action="click->item#getItems click->toggle#hide" data-toggle-target="taskTitle">
        <%= task.title %>
      </button>

      <%# Task title edit form that replaces task title button above when edit task title button is pressed %>
      <form class="hidden" id="task-edit data-toggle-target="editItemTitleForm" >
        <input type="text" data-toggle-target="changeTitleInput" placeholder=<%= task.title %>><br>
        <input type="hidden" data-toggle-target="currentTaskId" value="<%= task.id %>">
        <input type="hidden" data-toggle-target="currentWorkflowId" value="<%= workflow.id %>">
        <input type="submit" data-action="click->toggle#updateTaskTitle">
      </form>

      <%#button to change task title %>
      <% unless workflow.activated? %>
        <button class="m-1 shadow-md hidden" data-action="click->toggle#displayEditTitleForm" data-toggle-target="editItemButton">
          <i class="fas fa-edit"></i>
        </button>
      <% end %>
      

      <% if task.completed == "completed" %>
        <button class='inline-block text-gray-500 text-sm disabled'>
          <i class="fas fa-check"></i> Completed
        </button>
      <% elsif task.completed == "current" %>
        <button data-action="click-> task#markComplete" class='inline-block text-indigo-500 text-sm' data-task-id=<%= task.id %>>
          <i class="far fa-check-square"></i> Mark as complete
        </button>
      <% end %>

    </div>

    <div class="hidden flex" data-item-target="taskcontent" data-toggle-target="hide" >

      <%# task description / task desc input (delongs to title edit form) %>
      <h4 class="w-full" data-toggle-target="taskDescription"><%= task.description %></h4>

      <input class="hidden" form="task-edit" type="text" data-toggle-target="changeDescriptionInput"><br>

      <ul data-item-target="list" >
      </ul>

      <% if !workflow.activated? %>
        <%= render partial: 'items/itemadd', locals: {task_id: task.id, workflow: workflow} %>
      <% end %>

    </div>

  </div>
</div>
