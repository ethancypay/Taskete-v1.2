
<div data-task-id=<%= task.id %> data-workflow-id=<%= workflow.id %> data-controller="item toggle notification">
  <div class="t-card p-4 mb-2 mx-6 <%= task.current? ? "border-indigo-600 border-2" : "border" %>">
    <div class="flex justify-between">

      <button class="text-lg flex-grow flex items-center text-left" data-action="click->item#getItems click->toggle#toggleHideTitleForm" data-toggle-target="taskTitle">
        <svg class="mr-4" xmlns="http://www.w3.org/2000/svg" width="13" height="15" viewBox="0 0 14 16">
          <path id="paper_1" d="M266,416h-7a2.006,2.006,0,0,0-2,2v12a2.006,2.006,0,0,0,2,2h10a2.006,2.006,0,0,0,2-2v-9A5,5,0,0,0,266,416Zm3,14H259V418h5v5h5Zm-3-9v-3a3.009,3.009,0,0,1,3,3Z" transform="translate(-257 -416)"/>
        </svg>
        <%= task.title %>
      </button>

      <%# Task title form %>
      <div class="flex-grow flex justify-between items-center hidden" data-toggle-target="taskTitleForm">

        <%= simple_form_for task, method: 'PATCH', namespace: task.id, html: {class: "w-full flex items-center"} do |f| %>
          <svg class="mr-4" xmlns="http://www.w3.org/2000/svg" width="13" height="15" viewBox="0 0 14 16">
            <path id="paper_1" d="M266,416h-7a2.006,2.006,0,0,0-2,2v12a2.006,2.006,0,0,0,2,2h10a2.006,2.006,0,0,0,2-2v-9A5,5,0,0,0,266,416Zm3,14H259V418h5v5h5Zm-3-9v-3a3.009,3.009,0,0,1,3,3Z" transform="translate(-257 -416)"/>
          </svg>
          <%= f.input :title,
                      label: false,
                      input_html: {class: "w-full text-lg bg-transparent outline-none",
                                  autocomplete: "off"
                      },
                      autofocus: true %>
        <% end %>

      </div>


      <button class='inline-block text-xs text-green-400 text-xs cursor-default <%= 'hidden' unless task.completed? %>'>
        <i class="fas fa-check text-xs"></i>&nbsp;Completed
      </button>

      <% if task.current? %>
        <button data-action="click->task#markComplete" class='<%= 'hidden' unless task.workflow.activated? %> inline-block text-gray-700 text-xs' data-task-id=<%= task.id %>>
          <i class="far fa-check-square"></i>&nbsp;Mark as complete
        </button>
      <% end %>

    </div>


    <%# this holds/inserts task_content %>
    <div class="relative hidden" data-item-target="taskcontent" data-toggle-target="hide" >
    </div>

  </div>
  <div class="t-connector h-5"></div>
</div>
